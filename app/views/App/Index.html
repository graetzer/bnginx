{{template "header.html" .}}
{{template "App/trailer.html" .}}

<div class="row">
	<div class="col-sm-11">
	<main>
	{{$user := .user}}
	{{range .posts}}
	<article>
		<div class="panel panel-default">
		  <div class="panel-heading">
		    <h3 class="panel-title">{{.Title}}<small class="pull-right">{{.UpdatedTime.Format "Mon Jan 2 15:04:05"}}</small></h3>
			{{if eq $user.UserId .AuthorId}}
				<a href="/admin/post/{{.PostId}}" title="Edit this Post">Edit</a>
			{{end}}
		  </div>
		  <div class="panel-body">
		    {{markdown .Body}}
			<a href="/post/{{.PostId}}/{{urlquery .Title}}#commentForm" title="Make a comment">
			
			{{if not .IsPage}}
			
			{{$count := commentCount .}}
			{{if eq $count 0}}Comment on this article{{else}}
			{{if eq $count 1}}One comment so far{{else}}
			View all {{$count}} Comments{{end}}{{end}}</a>
			
			{{end}}
		  </div>
		</div>
	</article>
	{{end}}
	
	{{/* Handling of next/back/empty */}}
	{{if eq .offset 0}}
		{{if len .posts | eq 0}}
			<h2>Oops!</h2>
			<p>It seems that I haven't added content yet</p>
		{{end}}
		{{if len .posts | eq 5}}
			<a href="/?offset={{add .offset 5}}">Next &raquo;</a>
		{{end}}
	{{else}}
		{{if len .posts | eq 0}}
			<h2>Oops!</h2>
			<p>There seems to be no content here</p>
			<a href="/?offset={{ sub .offset 5}}">&laquo; Back</a>
		{{end}}
	{{end}}
	</main>
	</div><!-- ./col-sm-11 -->
	
	<div class="col-xs-1">
	{{template "App/social.html" .}}
	</div>
</div><!-- /.row -->

{{template "footer.html" .}}
